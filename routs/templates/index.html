{% extends "base_generic.html" %}

{% load static %}
<link rel="stylesheet" href="{% static 'css/styles.css' %}">

{% block title %}<title>Веломаршруты</title>{% endblock %}

{% block content %}
    
    <div class="top-header-container">
        <img class="top-header-image" src="/images/icons/index_header_image.svg">
        <div class="top-header-text">
            <strong>Kazan Tracks - сайт с коллекцией велосипедных и пешеходных маршрутов Казани и её окрестностей</strong>
        </div>
    </div>
    
    <div class="index-header">
        <strong>Найди подходящий маршрут из категорий или посмотри всю <a href="{% url 'rout-list' %}">коллекцию</a></strong>
    </div>
    <div class="collection-container">
        {% if route_collections %}
            {% for collection in route_collections %}
                <div class="collection-card-background" id="url(/images/{{ collection.image }})">
                    <div class="collection-card">
                        <div class="collection-card-link-container">
                            <a class="collection-card-link" href="/routs/rout-list/{{ collection.get_url_params }}"> {{ collection.title }} </a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p class="message-nothing-was-found">Пока нет подборок</p>
        {% endif %}
    </div>

    <div class="index-header">
        <strong>Маршрут пройден? Понравилось? Узнай больше</a></strong>
    </div>
    <p class="text"><a href="https://t.me/kazantracks">Telegram</a></p>

<script>
    const collectionCards = document.getElementsByClassName('collection-card-background');

    if (collectionCards.length > 0) {
        function applyResizing(collectionCards, parentWidth, n) {
            let width = '192px';
            if (n != 4) {
                width = ((parentWidth - 8 * n) / n).toString() + 'px';
            }
            [...collectionCards].forEach(card => {card.style.width = width;});
        }

        function resizeCollectionCards() {
            const parentWidth = collectionCards[0].parentElement.offsetWidth;
            let n = 4;
            if (parentWidth < 800) {
                n = 1;
                if (parentWidth > 600) {
                    n = 3;
                }
                else if (parentWidth > 400) {
                    n = 2;
                }
            }
            applyResizing(collectionCards, parentWidth, n);
        }

        window.onresize = resizeCollectionCards;
    }

    window.onload = () => {
        if (collectionCards.length > 0) {
            resizeCollectionCards();
        }

        document.getElementById("home-button").style.display = 'none';
        document.getElementById("back-button").style.display = 'none';

        [...document.getElementsByClassName("collection-card-background")].forEach(item => {
            item.style.backgroundImage = item.id;
        });
    }
</script>
{% endblock %}